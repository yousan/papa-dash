仕様書：Discord通知用 IoT ボタン（Dash思想・自作）

1. 目的・背景
	•	物理ボタンを押すだけで Discord に通知を送信したい
	•	Amazon Dash Button の思想（単機能・低コスト・確実性）を再現したい
	•	スマホは 設定時のみ使用、通常運用では不要
	•	自作前提だが、過剰な汎用性は不要

⸻

2. 全体コンセプト（設計思想）
	•	単機能：ボタン押下 → Discord通知
	•	確実性優先：通信はデバイス単体で完結
	•	低消費電力：普段は Deep Sleep、押した時だけ通信
	•	設定の簡素化：BLE を使いスマホから初期設定
	•	低コスト：量産は考えず、個人自作で現実的な範囲

⸻

3. システム構成

3.1 構成概要

[物理ボタン]
     ↓
[ESP32]
  ├─ BLE（設定用）
  ├─ Wi-Fi（通信用）
  └─ Deep Sleep
     ↓
[Discord Webhook]

3.2 通信の役割分担

通信	用途	備考
BLE	初期設定・再設定	スマホ必須
Wi-Fi	通知送信	通常運用時のみ
スマホ	設定時のみ	常駐不要


⸻

4. ハードウェア仕様

4.1 使用マイコン
	•	ESP32 系（例：ESP32-C3 / ESP32-C6）
	•	必須機能
	•	Wi-Fi（HTTPS対応）
	•	BLE
	•	Deep Sleep

4.2 入出力
	•	入力
	•	物理ボタン ×1
	•	出力
	•	LED（任意、0〜1個）
	•	設定中 / 送信中の簡易表示

4.3 電源
	•	想定
	•	USB給電（開発・試作）
	•	電池運用（単三 / 単四 / LiPo）
	•	要件
	•	Deep Sleep 時は極低消費電力
	•	押下時のみ Wi-Fi 起動

⸻

5. ソフトウェア仕様（デバイス側）

5.1 動作モード

通常モード
	1.	Deep Sleep
	2.	ボタン押下で起床
	3.	Wi-Fi 接続
	4.	Discord Webhook に HTTPS POST
	5.	成功/失敗に応じて処理
	6.	Deep Sleep に戻る

設定モード
	•	BLE接続待受
	•	スマホアプリから設定受信
	•	設定完了後、通常モードへ

⸻

5.2 設定項目（BLE経由）
	•	Wi-Fi SSID
	•	Wi-Fi パスワード
	•	Discord Webhook URL
	•	送信メッセージ（固定文字列）
	•	設定完了フラグ

※ 設定値は NVS / Flash に永続化

⸻

5.3 Discord送信仕様
	•	通信方式：HTTPS POST
	•	宛先：Discord Webhook URL
	•	ペイロード例：

{
  "content": "ボタンが押されました"
}


⸻

6. ソフトウェア仕様（スマホ側）

6.1 役割
	•	BLE経由で設定を送信するのみ
	•	通常運用時の関与は一切なし

6.2 必須機能
	•	BLEデバイススキャン
	•	各設定項目の入力UI
	•	BLE GATT Write

6.3 非要件
	•	常駐動作
	•	バックグラウンド通知
	•	Discord通信機能

⸻

7. 開発環境

7.1 開発OS
	•	macOS

7.2 デバイス開発
	•	Arduino IDE
	•	言語：C++（Arduinoスタイル）

7.3 スマホアプリ
	•	iOS / Android（どちらか、または両方）
	•	OS標準 BLE API 使用

⸻

8. コスト目安（1台）

構成	目安コスト
最小構成（USB給電）	700〜1,300円
電池運用・実用	1,200〜2,500円
ケース込み	〜3,000円程度

※ Amazon Dash（実質0円）には及ばないが、思想的には近い

⸻

9. 非対応・割り切り事項
	•	BLEのみでの運用（スマホ必須）は採用しない
	•	汎用IoTプラットフォーム化はしない
	•	複数ボタン / 複雑なUIは対象外
	•	技適・製品販売は現時点では考慮しない

⸻

10. まとめ（設計の芯）
	•	通信は Wi-Fi
	•	設定は BLE
	•	普段は眠らせる
	•	ボタン1個で完結

これは

Amazon Dash Button を、個人が2026年に現実的に再設計した形

となる設計である。
